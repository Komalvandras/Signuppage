<!-- ---
import BaseLayout from "../layouts/BaseLayout.astro";
import LoginForm from "../components/LoginForm";
---
<BaseLayout title="Login - LevelNine">
  <div class="p-6">
    <LoginForm client:load />
  </div>
</BaseLayout> -->


---
import BaseLayout from "../layouts/BaseLayout.astro";
import LoginForm from "../components/LoginForm";

// ⬇ Load variables from .env (MONGODB_URI=...)
import dotenv from "dotenv";
dotenv.config();

// ⬇ (Optional) small example: connect to MongoDB and read a value
//    Delete this block if you don’t want DB access on the login page.
import { MongoClient } from "mongodb";

let usersCount: number | null = null;
try {
  if (!process.env.MONGODB_URI) {
    throw new Error("MONGODB_URI is missing. Add it to your .env");
  }

  const client = new MongoClient(process.env.MONGODB_URI);
  await client.connect();

  const db = client.db("myappdb");
  usersCount = await db.collection("users").countDocuments({});

  await client.close();
} catch (err) {
  console.error("MongoDB check failed:", err);
  usersCount = null;
}
---

<BaseLayout title="Login - LevelNine">
  <div class="p-6">
    <LoginForm client:load />
    {usersCount !== null && (
      <p class="mt-4 text-sm text-gray-500">Users in DB: {usersCount}</p>
    )}
  </div>
</BaseLayout>